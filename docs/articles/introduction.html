<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Introduction to bivariate polar plots using <code>polarplotr</code> &bull; polarplotr</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">polarplotr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/introduction.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/skgrange/polarplotr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to bivariate polar plots using <code>polarplotr</code></h1>
                        <h4 class="author"><strong>David Carslaw</strong></h4>
            
            <h4 class="date">3 November 2016</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>This document considers the use of bivariate polar plots applied to air pollution problems. Since the development of the <strong>openair</strong> package, which first made available the <code>polarPlot</code> function, there have been many further developments. These include:</p>
<ol style="list-style-type: decimal"><li>Clustering of polar plot concetration surfaces (Carslaw and Beevers, 2013).</li>
<li>Development of a bivarate Conditional Probability Function (Uria-Tellaetxe and Carslaw, 2014).</li>
<li>Extension to considering two pollutant species and a range of pair-wise statistics (Grange et al., 2016).</li>
</ol><p>This document summarises the main use of the polar plot functions with examples using real air quality data,</p>
<p>The <code>polarPlot</code> function plots a <em>bivariate polar plot</em> of concentrations. Concentrations are shown to vary by wind speed and wind direction.</p>
<p>For many, maybe most situations, increasing wind speed generally results in lower concentrations due to increased dilution through advection and increased mechanical turbulence. There are, however, many processes that can lead to interesting concentration-wind speed dependencies and we will provide a more theoretical treatment of this in due course. However, below are a few reasons why concentrations can change with increasing wind speeds.</p>
<ul><li><p>Buoyant plumes from tall stacks can be brought down to ground-level resulting in high concentrations under high wind speed conditions.</p></li>
<li><p>Particle suspension increases with increasing wind speeds e.g. from spoil heaps and the like.</p></li>
<li><p>&lsquo;Particle&rsquo; suspension can be important close to coastal areas where higher wind speeds generate more sea spray.</p></li>
<li><p>The wind speed dependence of concentrations in a street canyon can be very complex: higher wind speeds do not always results in lower concentrations due to re-circulation. Bivariate polar plots are very good at revealing these complexities.</p></li>
<li><p>As Carslaw et al. (2006) showed, aircraft emissions have an unusual wind speed dependence and this can help distinguish them from other sources. If several measurement sites are available, polar plots can be used to triangulate different sources.</p></li>
<li><p>Concentrations of NO<sub>2</sub> can increase with increasing wind speed &mdash; or at least not decline steeply due to increased mixing. This mixing can result in O<sub>3</sub> -rich air converting NO to NO<sub>2</sub>.</p></li>
</ul></div>
<div id="example-of-use" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#example-of-use" class="anchor"> </a></body></html>Example of use</h2>
<p>For these examples use will be made of air quality data from the UK and surface meteorological data from the <code>worldmet</code> package, available <a href="https://github.com/davidcarslaw/worldmet">here</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(openair)
<span class="kw">library</span>(polarplotr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(worldmet)

<span class="co"># import data from London North Kensington</span>
north_ken &lt;-<span class="st"> </span><span class="kw">importAURN</span>(<span class="dt">site =</span> <span class="st">"kc1"</span>, <span class="dt">year =</span> <span class="dv">2013</span>)

<span class="co"># import met data for site Heathrow London (which is the default)</span>
met &lt;-<span class="st"> </span><span class="kw">importNOAA</span>(<span class="dt">year =</span> <span class="dv">2013</span>)

<span class="co"># merge together, drop model met from north_ken</span>
north_ken &lt;-<span class="st"> </span><span class="kw">inner_join</span>(<span class="kw">select</span>(north_ken, -ws, -wd),
                        met, <span class="dt">by =</span> <span class="st">"date"</span>)</code></pre></div>
<p>We will also use data from a kerbside site (Marylebone Road).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># import data from London Marylebone Road</span>
mary &lt;-<span class="st"> </span><span class="kw">importAURN</span>(<span class="dt">site =</span> <span class="st">"my1"</span>, <span class="dt">year =</span> <span class="dv">2013</span>)

<span class="co"># merge together, drop model met from north_ken</span>
mary &lt;-<span class="st"> </span><span class="kw">inner_join</span>(<span class="kw">select</span>(mary, -ws, -wd),
                        met, <span class="dt">by =</span> <span class="st">"date"</span>)</code></pre></div>
<p>Basic polar plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/polarPlot.html">polarPlot</a></span>(north_ken, <span class="dt">pollutant =</span> <span class="st">"nox"</span>, <span class="dt">col =</span> <span class="st">"jet"</span>)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" width="300"></p>
<p>Useful options for <code>polarPlot</code> include:</p>
<ul><li><code>x</code>, the variable for the radial axis (wind speed by default). The radial axis can be any numeric variable. The choice of variable depends on teh application but is usually chosen to help differentiate sources in some way e.g.&nbsp;air temperature or a measure of atmospheric stability.</li>
<li><code>limits</code> to set the colour scale limits e.g. <code>limits = c(0, 100)</code>. This is useful for ensuring the same scale across different plots.</li>
<li><code>k</code>, which controls the smoothing parameter. Generally it is not necessary to adjust <code>k</code> but if there are too few data it can be difficult to fit a smooth surface. Reducing k e.g.&nbsp;to 50 or below might help produce a plot.</li>
</ul></div>
<div id="conditional-probability-function" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#conditional-probability-function" class="anchor"> </a></body></html>Conditional Probability Function</h2>
</div>
<div id="comparing-two-pollutants" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#comparing-two-pollutants" class="anchor"> </a></body></html>Comparing two pollutants</h2>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#references" class="anchor"> </a></body></html>References</h2>
<ol style="list-style-type: decimal"><li><p>Carslaw, D.C. and K. Ropkins, (2012). openair &mdash; an R package for air quality data analysis. Environmental Modelling &amp; Software. Volume 27-28, 52-61.</p></li>
<li><p>Carslaw, D.C., Beevers, S.D, Ropkins, K and M.C. Bell (2006). Detecting and quantifying aircraft and other on-airport contributions to ambient nitrogen oxides in the vicinity of a large international airport. Atmospheric Environment. 40/28 pp 5424-5434.</p></li>
<li><p>Carslaw, D.C., &amp; Beevers, S.D. (2013). Characterising and understanding emission sources using bivariate polar plots and k-means clustering. Environmental Modelling &amp; Software, 40, 325-329. <a href="doi:10.1016/j.envsoft.2012.09.005" class="uri">doi:10.1016/j.envsoft.2012.09.005</a></p></li>
<li><p>Uria-Tellaetxe, I. and D.C. Carslaw (2014). Source identification using a conditional bivariate Probability function. Environmental Modelling &amp; Software, Vol. 59, 1-9. <a href="http://www.sciencedirect.com/science/article/pii/S1364815214001339">open access version</a>.</p></li>
<li><p>Westmoreland, E.J., N. Carslaw, D.C. Carslaw, A. Gillah and E. Bates (2007). Analysis of air quality within a street canyon using statistical and dispersion modelling techniques. Atmospheric Environment. Vol. 41(39), pp.&nbsp;9195-9205.</p></li>
<li><p>Grange, S. K., Lewis, A. C. and D. C. Carslaw (2016). Source apportionment advances with bivariate polar plots, correlation, and regression techniques. Atmospheric Environment. 145, 128-134. <a href="http://www.sciencedirect.com/science/article/pii/S1352231016307166">open access version</a>.</p></li>
</ol></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a></li>
      <li><a href="#example-of-use">Example of use</a></li>
      <li><a href="#conditional-probability-function">Conditional Probability Function</a></li>
      <li><a href="#comparing-two-pollutants">Comparing two pollutants</a></li>
      <li><a href="#references">References</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by David Carslaw, Stuart Grange.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
